<!--services/web_frontend/templates/qna/detail.html-->
{% extends "common/base.html" %}
{% block title %}Libra | Q&A ìƒì„¸{% endblock %}
{% block head_extra %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/question.css') }}">
{% endblock %}

{% block content %}
<section class="qna-hero fade-in">
  <div class="container">
    <a class="btn ghost" href="{{ url_for('qna.qna_list') }}">ëª©ë¡ìœ¼ë¡œ</a>
  </div>
</section>

<section class="fade-in">
  <div class="container">
    <article class="qna-detail" id="qnaDetail" data-post-id="{{ it.id }}" aria-labelledby="qnaTitle">
        <p class="qna-meta">
        <span class="badge kind">{{ it.kind }}</span>
        {% if it.is_public %}
          <span class="badge public">ê³µê°œ</span>
        {% else %}<span class="badge private">ë¹„ê³µê°œ</span>{% endif %}
        <span>ì‘ì„±ì {{ it.author }}</span>
        <span>{{ it.created_at.strftime('%Y-%m-%d %H:%M') }}</span>
        <strong class="status {{ 'done' if it.status=='ë‹µë³€ì™„ë£Œ' else 'doing' }}">ìƒíƒœ: {{ it.status }}</strong>
        <!-- âœ… ì¢‹ì•„ìš” ë²„íŠ¼ì€ HTMLì— -->
        <button id="likeBtn" class="btn" data-post-id="{{ it.id }}">ì¢‹ì•„ìš” ğŸ‘ <span id="likeCnt">{{ it.like_count or 0 }}</span></button>
      </p>
      <div class="qna-body">{{ it.content }}</div>
    </article>

      <!-- ëŒ“ê¸€ ë¦¬ìŠ¤íŠ¸ -->
      <section id="comments" class="c-wrap" aria-label="ëŒ“ê¸€">
      <div class="c-head">ëŒ“ê¸€</div>

      <ul class="c-list">
        {% if comments %}
          {% for c in comments %}
            {% set d = c.depth or 0 %}
            <li class="c-item c-indent-{{ d }} {{ 'admin' if c.is_admin else '' }}">
              <div class="c-head">
                {{ 'ê´€ë¦¬ì' if c.is_admin else c.author }}
                <span class="c-time">{{ c.created_at.strftime('%Y-%m-%d %H:%M') }}</span>
              </div>
              <div class="c-body">{{ c.content | e }}</div>

              <!-- ëŒ€ëŒ“ê¸€ í¼ -->
              <form class="c-form" method="post" action="{{ url_for('qna.qna_comment', qid=it.id) }}">
                <input type="hidden" name="parent_id" value="{{ c.id }}">
                <div class="c-actions">
                  <input type="text" name="author" placeholder="ë‹‰ë„¤ì„(ì„ íƒ)" maxlength="20">
                  <textarea name="content" rows="2" placeholder="ëŒ€ëŒ“ê¸€ ì…ë ¥..." required></textarea>
                  <button type="submit" class="btn primary">ë“±ë¡</button>
                </div>
              </form>
            </li>
          {% endfor %}
        {% else %}
          <li class="c-item">
            <div class="c-body" style="color:#6c757d;">ì²« ëŒ“ê¸€ì„ ë‚¨ê²¨ë³´ì„¸ìš”.</div>
          </li>
        {% endif %}
        <a id="c-end"></a>
      </ul>

      <!-- ìƒˆ ëŒ“ê¸€ -->
      <form class="c-form" method="post" action="{{ url_for('qna.qna_comment', qid=it.id) }}">
        <div class="c-actions">
          <input type="text" name="author" placeholder="ë‹‰ë„¤ì„(ì„ íƒ)" maxlength="20">
          <textarea name="content" rows="3" placeholder="ëŒ“ê¸€ì„ ì…ë ¥í•˜ì„¸ìš”." required></textarea>
          <button type="submit" class="btn primary">ëŒ“ê¸€ ë“±ë¡</button>
        </div>
      </form>

      <!-- ê´€ë¦¬ì ë‹µë³€ ì „ìš© -->
      {% if session.get('user') == 'libra_admin' %}
      <form class="c-form" method="post" action="{{ url_for('qna.qna_answer', qid=it.id) }}">
        <label><strong>ê´€ë¦¬ì ë‹µë³€</strong></label>
        <textarea name="content" rows="3" placeholder="ê´€ë¦¬ì ë‹µë³€ì„ ì…ë ¥í•˜ì„¸ìš”." required></textarea>
        <div class="c-actions">
          <button type="submit" class="btn primary">ë‹µë³€ ë“±ë¡</button>
        </div>
      </form>
      {% endif %}
    </section>
  </div>
</section>
{% endblock %}
{% block scripts %}
<script src="{{ url_for('static', filename='js/question.js') }}"></script>
{% endblock %}


{% extends "common/base.html" %}

{% block title %}Libra - 마이 서비스{% endblock %}

{% block head_extra %}
  <!-- 페이지 전용 CSS -->
  <link rel="stylesheet" href="{{ url_for('static', filename='css/chartpage.css') }}">
  <!-- Chart.js가 필요하면 유지 (현재 기능상 꼭 필요 없으면 제거 가능) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js" defer></script>
{% endblock %}

{% block content %}
  <!-- 글로벌 로더 -->
  <div id="global-loader" aria-live="polite" aria-busy="true" style="display:none">
    <div class="gl-inner">
      <div class="gl-spinner"></div>
      <div class="gl-text">잠시만 기다려주세요…</div>
    </div>
  </div>

  <div class="container">
    <div class="main-layout">
      <!-- 왼쪽 패널 -->
      <aside class="control-panel">
        <div class="panel-section">
          <h3>내 정보</h3>
          <div class="table-info">
            <div class="info-item">
              <span class="label">이름</span>
              <span class="value" id="userName">-</span>
            </div>
            <div class="info-item">
              <span class="label">소속대학</span>
              <span class="value" id="userUniv">-</span>
            </div>
          </div>
        </div>

        <div class="panel-actions">
          <button class="action-btn secondary" id="btnSyncPredict" type="button">예측 점수 동기화</button>
          <button class="action-btn primary" id="btnGoProfile" type="button">내정보 관리</button>
          <a class="action-btn" id="btnGoAgent" href="{{ url_for('agent_ui.agent_page') }}">에이전트 서비스 (test)</a>
        </div>
      </aside>

      <!-- 오른쪽 영역 -->
      <section class="chart-area">
        <div class="chart-header">
          <h2>마이 서비스</h2>
        </div>

        <div class="chart-grid" id="chartGrid">
          <div class="chart-placeholder" id="chartPlaceholder">
            <div class="placeholder-content">
              <div class="placeholder-icon">👤</div>
              <h3>내 정보 기반 개인화 영역</h3>
              <p>왼쪽에서 내 정보를 확인하고, “예측 점수 동기화”를 누른 뒤 분석 결과를 확인하세요.</p>
            </div>
          </div>
        </div>

        <div class="chart-info">
          <div class="info-card">
            <h4>안내</h4>
            <div class="info-grid">
              <div class="info-item">
                <span class="label">학년별 입력 값</span>
                <span class="value">프로필 &gt; 회원정보 수정에서 입력</span>
              </div>
              <div class="info-item">
                <span class="label">저장 위치</span>
                <span class="value">USER_DATA 테이블</span>
              </div>
            </div>
          </div>
        </div>
      </section>

    </div>
  </div>
{% endblock %}

{% block scripts %}
  <!-- 서버 값 주입: userservice.js보다 먼저 -->
  <script>
    window.__USER__ = {
      name: {{ (usr_name|tojson) if usr_name is defined else '""' }},
      univ: {{ (usr_snm|tojson)  if usr_snm  is defined else '""'  }}
    };
  </script>

  <!-- 페이지 전용 JS -->
  <script src="{{ url_for('static', filename='js/userservice.js') }}" defer></script>
{% endblock %}
